<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>المشاهدة | وين ياخذنا الريح 2026</title>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">

  <style>
    body {
      margin:0;
      font-family: Tajawal, Arial, sans-serif;
      background:#06070b;
      color:#e9ecf7;
      padding:20px;
    }
    .container {
      max-width: 1100px;
      margin: auto;
    }
    h1 { margin-bottom: 6px; }
    .sub { color:#aab2d3; margin-bottom:14px; }

    .player {
      position: relative;
      padding-top: 56.25%;
      border-radius: 18px;
      overflow: hidden;
      background:#000;
    }
    iframe {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
    }

    .msg {
      margin-top:12px;
      color:#aab2d3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>وين ياخذنا الريح 2026</h1>
    <p class="sub">مشاهدة خاصة — الرابط محمي ومؤقت</p>

    <div class="player" id="player"></div>
    <div class="msg" id="msg"></div>
  </div>

  <script>
    async function load() {
      const me = await fetch("/.netlify/functions/me").then(r => r.json());
      if (!me.loggedIn) {
        location.href = "/";
        return;
      }

      const res = await fetch("/.netlify/functions/stream");
      const data = await res.json();

      if (!res.ok) {
        document.getElementById("msg").textContent = data.error;
        return;
      }

      const iframe = document.createElement("iframe");
      iframe.src = data.embedUrl;
      iframe.allow = "accelerometer; autoplay; encrypted-media; picture-in-picture";
      iframe.allowFullscreen = true;

      document.getElementById("player").appendChild(iframe);
    }

    load();
  </script>
</body>
</html>
